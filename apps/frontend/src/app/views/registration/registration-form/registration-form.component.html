<div class="registration-form-container">
    <div class="form-content">
        <header class="form-header">
            <h1>Formulário de Inscrição</h1>
            <p class="subtitle">Evento: {{ eventSlug() }}</p>
        </header>

        @if (isLoading()) {
        <app-loader></app-loader>
        } @else if (errorMessage() && !canRegister()) {
        <div class="error-card">
            <i class="icon">error</i>
            <h2>Não é possível se inscrever</h2>
            <p>{{ errorMessage() }}</p>
            <button class="btn-secondary" (click)="cancel()">
                Voltar para Eventos Disponíveis
            </button>
        </div>
        } @else {
        <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()" class="registration-form">
            <div class="form-section">
                <h3>Dados Pessoais</h3>

                <div class="form-group">
                    <label for="nome">Nome Completo *</label>
                    <input type="text" id="nome" formControlName="nome" class="form-control"
                        [class.invalid]="registrationForm.get('nome')?.invalid && registrationForm.get('nome')?.touched">
                    @if (registrationForm.get('nome')?.invalid && registrationForm.get('nome')?.touched) {
                    <span class="error-text">Nome é obrigatório</span>
                    }
                </div>

                <div class="form-group">
                    <label for="email">E-mail *</label>
                    <input type="email" id="email" formControlName="email" class="form-control"
                        [class.invalid]="registrationForm.get('email')?.invalid && registrationForm.get('email')?.touched">
                    @if (registrationForm.get('email')?.invalid && registrationForm.get('email')?.touched) {
                    <span class="error-text">E-mail válido é obrigatório</span>
                    }
                </div>
            </div>

            <div class="form-section">
                <h3>Informações da Inscrição</h3>

                <div class="form-group">
                    <label for="categoria">Categoria *</label>
                    <select id="categoria" formControlName="categoria" class="form-control"
                        [class.invalid]="registrationForm.get('categoria')?.invalid && registrationForm.get('categoria')?.touched">
                        <option value="">Selecione uma categoria</option>
                        <option value="estudante">Estudante</option>
                        <option value="profissional">Profissional</option>
                        <option value="palestrante">Palestrante</option>
                    </select>
                    @if (registrationForm.get('categoria')?.invalid && registrationForm.get('categoria')?.touched) {
                    <span class="error-text">Categoria é obrigatória</span>
                    }
                </div>

                <div class="form-group">
                    <label for="instituicao">Instituição</label>
                    <input type="text" id="instituicao" formControlName="instituicao" class="form-control"
                        placeholder="Universidade, empresa, etc.">
                </div>

                <div class="form-group">
                    <label for="observacoes">Observações</label>
                    <textarea id="observacoes" formControlName="observacoes" class="form-control" rows="4"
                        placeholder="Informações adicionais (opcional)"></textarea>
                </div>
            </div>

            @if (errorMessage()) {
            <div class="form-error">
                <i class="icon">warning</i>
                {{ errorMessage() }}
            </div>
            }

            <div class="form-actions">
                <button type="button" class="btn-secondary" (click)="cancel()" [disabled]="isSubmitting()">
                    Cancelar
                </button>
                <button type="submit" class="btn-primary" [disabled]="isSubmitting()">
                    @if (isSubmitting()) {
                    <span>Enviando...</span>
                    } @else {
                    <span>Confirmar Inscrição</span>
                    }
                </button>
            </div>
        </form>
        }
    </div>
</div>